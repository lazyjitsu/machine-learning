<canvas id="myCanvas" width="500px" height="500px" style="background-color:darkred;"
</canvas>

<style>
  body {
    margin:0;
    overflow: hidden;
  }
</style>
<script>
  const ctx = myCanvas.getContext('2d');
  const point={x:90,y:120};
  const G = {x:20,y:50};
  const offset = {x:myCanvas.width/2,y:myCanvas.height/2};
  ctx.translate(offset.x,offset.y);
  document.onmousemove=(event) => {
    point.x=event.x-offset.x;
    point.y=event.y-offset.y;

    update();
  }

  function update() {
    ctx.clearRect(-offset.x,-offset.y,myCanvas.width,myCanvas.height);
    drawCoordinateSystem(ctx);

    
    drawArrow({x:0,y:0},point,20,"red");
    drawArrow({x:0,y:0},G,20,"red");
    const resultAdd=addVectors(point,G);

    drawArrow({x:0,y:0},resultAdd,20,"white");
    drawArrow(point,resultAdd);
    drawArrow(G,resultAdd,20,"black");

    ctx.beginPath();
    ctx.setLineDash([3,3]);
    ctx.moveTo(G.x,G.y);
    ctx.lineTo(resultAdd.x,resultAdd.y);
    ctx.lineRTo(point.x,point.y);
    ctx.stroke();
    ctx.setLinDash([]);
    drawArrow({x:0,y:0},resultAdd,"red");
    drawArrow(point,resultAdd);
  }
  function toXY({mag,dir}) {
    return {
      // given the angle in dir, give me the sides by canceling out the hypotenuse aka mag
      x: Math.cos(dir)*mag,
      y: Math.sin(dir)*mag
    }
  }

  function direction({x,y}) {
    //given the sides, y and x, give me the angle!
    // Math.atan(y/x) gives us (-90deg, +90deg) --> (-Math.PI/2,+Math.PI/2)
    //  return Math.atan(y/x);
    // the parameters are different
    return Math.atan2(y,x);
  }


  function magnitude({x,y}) { // object destructuring
    return Math.hypot(x,y);
  }
  function toPolar({x,y}) {
    return {
      dir: direction({x,y}),
      mag: magnitude({x,y})
    }
  }
  function distance(p) {
    return Math.sqrt(p.x**2+p.y**2);
  }
  function drawArrow(tail,tip,size=20,color="green") {
    const {dir,mag} = toPolar(subtractVectors(tip,tail));
    const v1 = { dir:dir+Math.PI*0.8,mag:size/2 };
    const p1 = toXY(v1);
    const t1 = addVectors(p1,tip);
    const v2 = { dir:dir-Math.PI*0.8,mag:size/2 };
    const p2 = toXY(v2);
    const t2 = addVectors(p2,tip);
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(tail.x,tail.y);
    ctx.lineTo(tip.x,tip.y);
    ctx.strokeStyle=color;
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(tip.x,tip.y);
    ctx.lineTo(t1.x,t1.y);
    ctx.lineTo(t2.x,t2.y);
    ctx.closePath();
    ctx.fillStyle=color;
    ctx.fill();
    ctx.stroke();
  }
  function drawCoordinateSystem(ctx,color="lightgray") {
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(-offset.x,0);
    ctx.lineTo(offset.x,0);
    ctx.moveTo(0,-offset.y);
    ctx.lineTo(0,offset.y);
    ctx.setLineDash([5,4]);
    ctx.stroke();
    ctx.setLineDash([]);
  }
  function addVectors(v1,v2) {
    return {
      x: v1.x + v2.x,
      y: v1.y + v2.y
    }
  }
  function subtractVectors(v1,v2) {
    return {
      x: v1.x - v2.x,
      y: v1.y - v2.y
    }
  }
  function drawPoint(loc,size=10,color="white") {
    ctx.beginPath();
    ctx.fillStyle=color;
    ctx.arc(loc.x,loc.y,size/2,0,Math.PI*2);
    ctx.fill();
  }
  function drawLine(p1,p2,color="gray") {
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(p1.x,p1.y);
    ctx.lineTo(p2.x,p2.y);
    ctx.stroke();
  }



</script>
