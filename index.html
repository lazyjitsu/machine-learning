<canvas id="myCanvas" width="500px" height="500px" style="background-color:darkred;"
</canvas>

<style>
  body {
    margin:0;
    overflow: hidden;
  }
</style>
<script>
  const ctx = myCanvas.getContext('2d');
  const point={x:90,y:120};
  const offset = {x:myCanvas.width/2,y:myCanvas.height/2};
  ctx.translate(offset.x,offset.y);
  document.onmousemove=(event) => {
    point.x=event.x-offset.x;
    point.y=event.y-offset.y;

    update();
  }

  function update() {
    ctx.clearRect(-offset.x,-offset.y,myCanvas.width,myCanvas.height);
    drawCoordinateSystem(ctx);

    drawPoint(point);
    drawPoint({x:50,y:-120},10,"black");
    drawPoint({x:150,y:-220},10,"black");

    drawLine({x:0,y:0},{x:50,y:-120});
    drawLine({x:50,y:-120},{x:150,y:-220},"orange");
    const same = toXY(toPolar(point));
    console.log("Same: ",same);
    drawPoint(same,5,"blue");
    drawArrow(point,22,"green");

  }
  function toXY({mag,dir}) {
    return {
      // given the angle in dir, give me the sides by canceling out the hypotenuse aka mag
      x: Math.cos(dir)*mag,
      y: Math.sin(dir)*mag
    }
  }

  function direction({x,y}) {
    //given the sides, y and x, give me the angle!
    // Math.atan(y/x) gives us (-90deg, +90deg) --> (-Math.PI/2,+Math.PI/2)
    //  return Math.atan(y/x);
    // the parameters are different
    return Math.atan2(y,x);
  }

  function magnitude({x,y}) { // object destructuring
    return Math.hypot(x,y);
  }
  function toPolar({x,y}) {
    return {
      dir: direction({x,y}),
      mag: magnitude({x,y})
    }
  }
  function distance(p) {
    return Math.sqrt(p.x**2+p.y**2);
  }
  function drawArrow(tip,size=50,color="green") {
    const {dir,mag} = toPolar(tip);
    const v1 = { dir:dir+Math.PI/2,mag:size/2 };
    const p1 = toXY(v1);
    const t1 = {
      x:p1.x + tip.x,
      y:p1.y + tip.y
    }
    drawPoint(t1,5);
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(0,0);
    ctx.lineTo(tip.x,tip.y);
    ctx.strokeStyle=color;
    ctx.stroke();
  }
  function drawCoordinateSystem(ctx,color="lightgray") {
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(-offset.x,0);
    ctx.lineTo(offset.x,0);
    ctx.moveTo(0,-offset.y);
    ctx.lineTo(0,offset.y);
    ctx.setLineDash([5,4]);
    ctx.stroke();
    ctx.setLineDash([]);
  }
  function drawPoint(loc,size=10,color="white") {
    ctx.beginPath();
    ctx.fillStyle=color;
    ctx.arc(loc.x,loc.y,size/2,0,Math.PI*2);
    ctx.fill();
  }
  function drawLine(p1,p2,color="gray") {
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.moveTo(p1.x,p1.y);
    ctx.lineTo(p2.x,p2.y);
    ctx.stroke();
  }



</script>
